# 出退勤・残業管理アプリ設計書

## ✅ プロジェクト概要

### 🎯 目的
製造業などの職場で、社員の出退勤記録・残業管理を簡単に行えるVBAアプリケーションを作成。社員証の2Dバーコードを利用して記録を自動化し、シェイプ（名札）による可視化・ログ記録・データ保存を行います。

---

## 🔧 主な機能

| 機能                                         | 説明                                                                                         |
| -------------------------------------------- | -------------------------------------------------------------------------------------------- |
| **バーコード読取で出勤・退勤記録**           | 2Dバーコードを読み取り、社員コードで名札の色を自動変更（出勤：黄色、退勤：赤）               |
| **残業可否の表示**                           | 可：◯／不可：✗ を社員データに記録し、プレート枠の色も変更（可なら水色）                      |
| **残業時間の記録**                           | 社員ごとの残業時間を入力／記録する                                                           |
| **名札の自動配置**                           | 社員名から自動的に名札（シェイプ）を整列表示                                                 |
| **残業配置用の名札生成**                     | 残業者用に水色の名札を別で生成し、視覚的に分けて配置                                         |
| **名札位置の保存／復元**                     | 配置された名札の位置を記録・次回起動時に復元                                                 |
| **作業ポジションのログ記録**                 | 各名札の配置座標から作業ポジションの履歴を記録し、配置傾向や負荷の見える化に活用             |
| **既存システムから名札位置データを読み取り** | 既存のシステムで配置されたシェイプの位置情報を取得し、新システムにて自動再配置する機能を実装 |
| **名札の整列集約機能**                       | 出勤名札・残業名札をボタン操作で一括選択・整列配置（所定位置に自動整理）する機能を実装       |
| **事前休暇者名札の自動移動**                 | 事前休暇者表をもとに、該当する名札を「事前休暇欄」へ自動で移動・配置する機能を実装           |
| **データのバックアップ**                     | 本データを定期的にCSVとシートに保存（自動バックアップ）                                      |
| **エラーログの記録**                         | モジュール名・行番号を含む詳細なログを「ログ」シートに記録                                   |

---

## 🔄 既存システムから新システムへの移行プラン

### ✅ ステップ1：既存機能とデータ構造の棚卸し
- 現行システムのVBAコード・マクロを一覧化
- 既存データ（社員情報、勤怠履歴、残業情報、ポジション配置）を確認
- 不具合や運用課題をリストアップ（例：操作ミス、パフォーマンス、可視化不足）

### ✅ ステップ2：スクラッチ開発計画
- 新システムはGitHub管理で構成し直し、モジュール分割を実施
- コードは命名規則と責務に基づいて再設計（main.bas、logging.bas、skill.basなど）
- ユーザーインターフェースはボタン/シート/フォームで一新

### ✅ ステップ3：データ移行
- 既存データを新フォーマットに変換（社員マスタ、勤怠履歴、名札座標など）
- 移行用の一括取り込みマクロを作成
- 旧ファイルを読み取り専用に変更

### ✅ ステップ4：段階的テストと並行運用
- テスト環境で操作・データ連携を検証（単体／統合テスト）
- 並行運用で1週間以上本番と同様の運用を実施
- 不具合・運用改善点をフィードバックし修正

### ✅ ステップ5：本番切り替え・旧システムのアーカイブ
- 本番システムに切替後、旧ファイルはアーカイブ保存
- 操作マニュアルや教育資料を配布
- 保守ルールを整備し、継続的な改良に備える

---

